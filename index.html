<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"> -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  </head>
  <body>
    <div class='container'>
      <div id='results' class='row'></div>
    </div>

<script src='https://cdnjs.cloudflare.com/ajax/libs/seedrandom/2.3.10/seedrandom.min.js'></script>
<script>
const users = [
  "alex.bui",
  "alexis.theyssier",
  "amel.braiek",
  "aurelio.lima.ferreira",
  "benoit.rameau",
  "bogdan.ceu",
  "capucine.leclerc",
  "carlos.facchin",
  "charles.chiacchia",
  "charlotte.guerin",
  "christian.lim",
  "christopher.fremond",
  "constance.henrot",
  "daniel.deutsch",
  "edouard.de.laage",
  "francesca.ringot",
  "frederic.olive",
  "frederic.paquet",
  "gaelle.fougre",
  "guillaume.nobis",
  "helena.domlan",
  "helene.blanchard",
  "joffrey.chauleau",
  "kim.spychalski",
  "leila.rhazaoui",
  "lorraine.chastang",
  "louise.foussat",
  "ludivine.pellissier",
  "marie.malarme",
  "mehdi.chtira",
  "mikael.verdu",
  "hedi.kochad",
  "mohand.hassam",
  "nadia.djellali",
  "pany.soukaloun",
  "philippe.maguer",
  "pierre.langevin",
  "pierre.poretti",
  "quentin.roiseux",
  "romain.reslinger",
  "sabrina.berguer",
  "samy.kacemi",
  "samuel.sarano",
  "samuel.lambert",
  "sichelle.chiffert",
  "smain.khaldi",
  "sophie.michaudel",
  "souhail.souid",
  "valery.chin",
  "yann.coulleau",
  "yvan.latorre",
]

const getUrlParams = url => {
  let hashes = url.slice(url.indexOf('?') + 1).split('&')
  let params = {}
  hashes.map(hash => {
    let [key, val] = hash.split('=')
    params[key] = decodeURIComponent(val)
  })

  return params
}

const shuffle = (array, shouldShuffleInPlace = false) => {
  let n = array.length
  let i, tmp

  if (!shouldShuffleInPlace) {
    array = [ ...array ]
  }
  while (n) {
    i = Math.floor(Math.random() * n--)

    tmp = array[i]
    array[i] = array[n]
    array[n] = tmp
  }

  return array
}

const splitArrayInChunks = (array, chunkSize) => {
  const chunks = []

  for (i = 0; i < array.length; i += chunkSize) {
    chunks.push(array.slice(i, i + chunkSize))
  }

  return chunks
}

const splitArrayInBalancedChunks = (array, n) => {
  const sizes = []
  const chunks = []

  const each = Math.floor(array.length / n)
  const rest = array.length % n

  for (let i = 0; i < n; i++) {
    sizes.push(each + (i < rest ? 1 : 0))
  }
  let i = 0
  for (size of sizes) {
    chunks.push(array.slice(i, i + size))
    i += size
  }

  return chunks
}

const qs = window.location.search
const params = getUrlParams(qs)
const n = Number(params.groups) || 9
const seed = Number(params.seed) || Math.floor(Math.random() * 10000)

Math.seedrandom(seed)

const groups = splitArrayInBalancedChunks(shuffle(users), n)
const groupSizes = groups.map(g => g.length)

const results = groups.map((group, i) => {
  const title = `<h5>Group #${i + 1} (${group.length})</h5>`
  const list = `
    <ul class="list-group">
      ${group.map(user => `<li class="list-group-item p-1">${user}</li>`).join('')}
    </ul>
  `
  return `<div class='col-lg-3 col-md-4 col-sm-6 col-12 p-1'>${title}${list}</div>`
}).join('')

const resultsDiv = document.getElementById('results')
resultsDiv.innerHTML = results

</script>
  </body>
</html>